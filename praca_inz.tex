
\documentclass[a4paper]{article}

\usepackage[polish]{babel}
\usepackage{lmodern} %Type1-font for non-english texts and characters
\usepackage{amsmath}%
\usepackage{amsfonts}%
\usepackage{graphicx}
\usepackage[T1]{fontenc}
\usepackage{polski}
\usepackage[cp1250]{inputenc}
\usepackage{svg}
\usepackage{float}
\usepackage{enumerate}
\usepackage{indentfirst}



%-------------------------------------------


\setlength{\textwidth}{\paperwidth}
\addtolength{\textwidth}{-5cm}
\setlength{\textheight}{\paperheight}
\addtolength{\textheight}{-5cm}
\setlength{\oddsidemargin}{0cm}
\setlength{\evensidemargin}{0cm}
\topmargin -1.25cm
\footskip 1.4cm
\graphicspath{ {./fig/} }



\title{POLITECHNIKA POZNAÑSKA
\vspace{0.2cm}

\Large WYDZIA£ AUTOMATYKI, ROBOTYKI I ELEKTROTECHNIKI

INSTYTUT ROBOTYKI I INTELIGENCJI MASZYNOWEJ

ZAK£AD STEROWANIA I ELEKTRONIKI PRZEMYS£OWEJ
\vspace{1cm}
\begin{figure}[H]
\centering
\includegraphics{logo.png}   
\end{figure} 
\vspace{1cm}
PRACA DYPLOMOWA 

IN¯YNIERSKA
\vspace{1cm}

Mikroprocesorowy kaskadowy uk³ad regulacji pr¹du, prêdkoœci i po³o¿enia dla napêdu z silnikiem BLDC
\vspace{2cm}
\begin{flushleft}
\normalsize

\hspace{8cm}PROMOTOR:

\hspace{8cm}DR IN¯. DOMINIK £UCZAK
\vspace{0.2cm}

\scriptsize \hspace{8cm}POTWIERDZAM PRZYJÊCIE PRACY
\vspace{0.5cm}

\hspace{8cm}...........................


\scriptsize \hspace{8cm}DATA I PODPIS PROMOTORA
\end{flushleft}
\vspace{0.5cm}
}

\author{MATEUSZ SEMK£O}

\date{2020-10-25}



\begin{document}
\maketitle
\newpage
\tableofcontents
\newpage


\section{Wstêp}

W ramach pracy in¿ynierskiej zosta³ zbudowany uk³ad napêdowy z regulacj¹ pr¹du, prêdkoœci i k¹ta obrotu wirnika dla silnika BLDC  (ang.\textit{ BrushLess Direct-Current motor}) . G³ównym za³o¿eniem jest pokazanie mo¿liwoœci wykorzystania mikroprocesora jako jednego ze sposobów na realizacje uk³adu sterowania.

 Zbudowany prototyp wykorzystuje rdzeñ ARM Cortex-M4  jako g³ówn¹ jednostkê obliczeniow¹ i odpowiedzialny jest za proces regulacji. Procesor wbudowany  w p³ytê prototypow¹ B G431B-ESC1 firmy STMicroelectronics posiada wszystkie wymagane peryferia.  Sterownik B G431B ESC1 za pomoc¹ ³¹cza szeregowego UART sprzê¿ony zosta³  z mikrokontrolerem NUCLEO-F746ZG firmy STMicroelectronics  wyposa¿onym w rdzeñ ARM Cortex-M7. Odpowiedzialny  jest za komunikacje poprzez Ethernet i protokó³ TCP/IP z interfejsem u¿ytkownika oraz równolegle ze sterownikiem pobiera informacje z czujników. Rozwi¹zanie to umo¿liwia wykorzystanie mocy obliczeniowej tylko  do procesu regulacji. Silnik BLDC nale¿y do rodziny silników synchronicznych z magnesami trwa³ymi. W zwi¹zku z ich w³aœciwoœciami oraz coraz czêstszym wykorzystywaniu  w automatyce i robotyce sta³ siê obiektem, na podstawie którego przeprowadzono badania opisane w niniejszej pracy. Silnik  ze wzglêdu na konstrukcje wymaga bardziej z³o¿onego sposobu sterowania w porównaniu z silnikiem pr¹du sta³ego. FOC (ang. Field-orient control) jest jedn¹ z technik sterowania silnikiem trójfazowym. Pozwala ona sprowadziæ parametry silnika z   trójwymiarowego uk³ad wspó³rzêdnych do wiruj¹cego uk³adu o dwóch wspó³rzêdnych zgodnych z wektorem strumienia wirnika i sterowaæ trójfazowym silnikiem synchronicznym o magnesach trwa³ych  w taki sam sposób jak silnikiem pr¹du sta³ego.
 
Kolejne rozdzia³y opisuj¹ sposób, schematy, etapy dzia³añ i wyniki obliczeñ  zbudowanego prototypu uk³adu napêdowego dla silnika BLDC. 

\newpage


\section{Silnik BLDC}
\subsection{Budowa silnika BLDC}
Bezszczotkowe silniki z magnesami trwa³ymi mo¿na podzieliæ na silniki pr¹du sta³ego BLDC (ang. BrushLess Direct-Current motor) oraz synchroniczne silniki pr¹du przemiennego PMSM (ang. Permanent Magnet Synchronous Motor). Ró¿ni¹ siê one kszta³tem przebiegu si³y elektromotorycznej. W silniku BLDC przyjmuje kszta³t trapezoidalny a silnik PMSM  sinusoidalny \cite{goryca2012metody}.

\begin{figure}[H]
\centering
\includegraphics{przebieg_SEM.png} 

\caption{Przebiegi si³y elektromotorycznej E, pr¹du I i momentu T dla jednej fazy dla:
 a) silnika PMSM, b) silnika BLDC \cite{zajkowski2013sterowanie} }
\label{fig:1}
\end{figure} 

Istnieje wiele odmian silników BLDC ró¿ni¹cych siê budow¹, konstrukcj¹ obwodów magnetycznych, rozk³adem indukcji i kszta³tem si³ elektromotorycznych. Uzwojenie  twornika jest zazwyczaj w stojanie i jest uzwojeniem trójfazowym. Kszta³t magnesów, trwa³e umieszczonych na wirniku zapewniaj¹ sta³¹ wartoœæ indukcji w szczelinie maszyny i trapezoidalny kszta³t si³y elektromotorycznej\cite{krykowski}.

\begin{figure}[H]
\centering
\includegraphics[width=8cm]{stojan.png}   
\caption{Stojan silnika BLDC \cite{goryca2012metody}}
\label{fig:2}
\end{figure} 

\begin{figure}[H]
\centering
\includegraphics[width=8cm]{wirnik.png}   
\caption{Wirnik silnika BLDC \cite{goryca2012metody}}
\label{fig:3}
\end{figure} 

\subsection{Zasada dzia³ania sinika BLDC}
Silnik elektryczny przetwarza dostarczon¹ energiê elektryczn¹ w energiê mechaniczn¹. Ruch wirnika wystêpuje, gdy zasilaj¹c odpowiednie uzwojenia stojana nastêpuje pojawienie siê wiruj¹cego pola elektromagnetycznego, które oddzia³uje na pole magnetyczne wirnika i wprawia go w ruch. Strumienie magnetyczne wirnika i stojana powinny byæ wzglêdem siebie nieruchome. W klasycznym silniku pr¹du sta³ego powy¿szy warunek jest spe³niony przez odpowiednie umiejscowienie szczotek komutatora wzglêdem pola stojana.
Z powodu braku klasycznego komutatora w silniku BLDC zapewnienie wirowania strumienia stojana synchronicznie z wirnikiem jest realizowane przez odpowiednie prze³¹czanie uzwojeñ. W tym celu 
wykorzystuje siê przetwornik energoelektroniczny, którego zadaniem jest odpowiednie usytuowanie strumieni wzglêdem siebie, poprzez prze³¹czanie tranzystorami mocy. Aby to zrealizowaæ potrzebna jest wiedza o aktualnym po³o¿eniu k¹ta obrotu wirnika, wykorzystuj¹c czujniki Halla lub przetworniki obrotowo-impulsowe\cite{krykowski}.

Na rysunku \ref{fig:4} pokazano uproszczony schemat uk³adu sterowania i zasilania silnika BLDC.
 



\begin{figure}[H]
\centering
\includegraphics[width=8cm]{sterowanie_BLDC.png}   
\caption{Uproszczony schemat uk³adu sterowania i zasilania silnika \cite{domoracki2005silniki}}
\label{fig:4}
\end{figure} 


\subsection{Sposoby sterowania}

Silnik bezszczotkowy  nie posiada konwencjonalnego komutatora , wiêc stale nale¿y kontrolowaæ po³o¿enie wirnika oraz zastosowaæ odpowiedni sposób za³¹czania uzwojeñ. Istniej¹ trzy podstawowe strategie komutacji:[2]
\begin{itemize}
\item komutacja trapezoidalna – prze³¹czanie uzwojeñ odbywa siê w sposób dyskretny wiêc nie jest potrzebny ci¹g³y pomiar k¹ta obrotu wa³u. Najczêœciej wykorzystujê siê czujniki Halla, które s¹ rozmieszczone w odstêpach 120 stopni lub bezczujnikowe obliczanie po³o¿enia wirnika. Zmiana stanu jednego z czujników inicjujê rozpoczêcie zmiany zasilania uzwojeñ stojana. Zasilane s¹ jednoczeœnie tylko dwa uzwojenia.[1]
\item komutacja sinusoidalna – prze³¹czanie uzwojeñ odbywa siê w sposób quasi-ci¹g³y. Pr¹dy fazowe i si³y elektromotoryczne powinny byæ sinusoidalne. Przekszta³tnik energoelektroniczny pe³ni funkcje falownika. Do pomiaru po³o¿enia wykorzystuje siê przetwornik impulsowo-obrotowy lub algorytm do bezczujnikowego obliczania k¹ta obrotu wirnika.  Zasilane s¹ jednoczeœnie  trzy  uzwojenia. [1]
\item zastosowanie algorytmu FOC (ang. Field Orient Control).\\
 Metoda ta zosta³a wykorzystana w niniejszej pracy i opisana w rozdziale \ref{chapter:1}.
\end{itemize}


\subsection{Model matematyczny}
Wartoœæ momentu elektromagnetycznego wytworzonego dla p³askiego fragmentu si³y elektromotorycznej przez pr¹d p³yn¹cy w jednym uzwojeniu fazowym \cite{krykowski}:

\begin{equation} \label{eqn:1}
 Me=p \psi _{p} i 
\end{equation}


Me - moment elektromagnetyczny

p - liczba par biegunów

$\psi _{p}$ -strumieñ magnetyczny wytworzony przez wirnik a skojarzony z uzwojeniem stojana

i - pr¹d uzwojenia stojana 
\\

Chwilowa wartoœæ strumienia skojarzonego z k-tym uzwojeniem zmieniaj¹ca siê w funkcji obrotu wirnika \cite{krykowski}:
\begin{equation} \label{eqn:2}
 \psi _{k}(\theta _{e})=\psi _{p}f(\theta _{e})
\end{equation}

$\theta _{e}$ - elektryczny k¹t po³o¿enia wirnika
\\

£¹cz¹c powy¿sze Wyra¿enia \ref{eqn:1} i \ref{eqn:2} uzyskujemy moment elektromagnetyczny dla k-tej fazy \cite{krykowski}:
 
 
\begin{equation} \label{eqn:3}
 M_{ek}=p \psi _{k}(\theta _{e}) i 
\end{equation} 

Moment ca³kowity jest równy sumie momentów elektromagnetycznych\cite{krykowski}:

\begin{equation} \label{eqn:9}
 M_{e}=\sum_{k=1}^{3} M_{ek}
\end{equation} 

Równanie ruch ma postaæ:
\begin{equation} \label{eqn:10}
 M_{e}=J \frac{d\omega}{dt}+M
\end{equation} 

J - moment bezw³adnoœci

M - moment oporowy
\\

Wzór dla p³askiego odcinka si³y elektromotorycznej\cite{krykowski}:

\begin{equation} \label{eqn:4}
 E_{p}=p \psi _{p}\omega
\end{equation} 

$\omega$ - prêdkoœæ obrotowa wirnika 
\\

Wyra¿enie opisuj¹ce si³ê elektromotoryczn¹ indukowan¹ w k-tym uzwojeniu\cite{krykowski}:

\begin{equation} \label{eqn:5}
 E_{k}=p \psi _{k}(\theta _{e})\omega
\end{equation} 
\\

Silnik BLDC mo¿na traktowaæ jako szczególny przypadek silnika synchronicznego.
Schemat silnika trójfazowego z magnesami trwa³ymi przedstawiony na rysunku \ref{fig:5}.

\begin{figure}[H]
\centering
\includegraphics[width=9cm]{model_silnik.png}   
\caption{Schemat silnika synchronicznego z magnesami trwa³ymi}
\label{fig:5}
\end{figure} 


M - indukcyjnoœæ wzajemna

L - indukcyjnoœæ w³asna

R - rezystancja uzwojeñ

E - si³a elektromotoryczna
\\

Zak³adaj¹c, ¿e indukcyjnoœci w³asne i rezystancje s¹ równe:\\
\begin{equation}
 L=L_{A}=L_{B}=L_{C}
 R=R_{A}=R_{B}=R_{C}
\end{equation}


oraz indukcyjnoœci wzajemne równie¿ to ca³kowita indukcyjnoœæ  jednej fazy jest równa:

\begin{equation}
 L_{S}=L-M
\end{equation}

Otrzymujemy wyra¿enie \cite{krykowski}:

\begin{equation} \label{eqn:6}
\begin{bmatrix}
U_{A}  \\
U_{B}  \\
U_{C}  \\
\end{bmatrix}
= R
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
I_{A}  \\
I_{B}  \\
I_{C}  \\
\end{bmatrix}
+L_{S}\frac{d}{dt}
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
I_{A}  \\
I_{B}  \\
I_{C}  \\
\end{bmatrix}
+
\begin{bmatrix}
E_{A}  \\
E_{B}  \\
E_{C}  \\
\end{bmatrix}
\end{equation} 

oraz

\begin{equation} \label{eqn:7}
\frac{d}{dt}
\begin{bmatrix}
I_{A}  \\
I_{B}  \\
I_{C}  \\
\end{bmatrix}
= - \frac{R}{L}
\begin{bmatrix}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 \\
\end{bmatrix}
\begin{bmatrix}
I_{A}  \\
I_{B}  \\
I_{C}  \\
\end{bmatrix}
-\frac{1}{L}
\begin{bmatrix}
E_{A}  \\
E_{B}  \\
E_{C}  \\
\end{bmatrix}
+\frac{1}{L}
\begin{bmatrix}
U_{A}  \\
U_{B}  \\
U_{C}  \\
\end{bmatrix}
\end{equation}
\\

Wykorzystuj¹c równanie \ref{eqn:10},\ref{eqn:7} , \ref{eqn:5} , \ref{eqn:3} i zapis na w postaci równaæ stanu \ref{eqn:8} uzyska siê pe³en model idealnego silnika o trapeziodalnej sile elektromotorycznej \cite{krykowski}:

\begin{equation} \label{eqn:8}
 \hat{x}=Ax+Bu
\end{equation} 

gdzie:

\begin{equation} \label{eqn:11}
 x=
\begin{bmatrix}
I_{A}  & I_{B}  & I_{C} & \omega & \theta
\end{bmatrix}^{T}
\end{equation} 

\begin{equation} \label{eqn:12}
 u=
\begin{bmatrix}
U_{A}  & U_{B}  & U_{C} & M
\end{bmatrix}^{T}
\end{equation} 

\begin{equation} \label{eqn:13}
 A=
\begin{bmatrix}
-\frac{R}{L}  & 0  & 0 & -p\psi_{A}(\theta_{e})/L & 0\\
0  & -\frac{R}{L}  & 0 & -p\psi_{B}(\theta_{e})/L & 0\\
0  & 0  & -\frac{R}{L} & -p\psi_{C}(\theta_{e})/L & 0\\
-p\psi_{A}(\theta_{e})/J & -p\psi_{B}(\theta_{e})/J & -p\psi_{C}(\theta_{e})/J & -B/J & 0 \\
0 & 0 & 0 & 1 & 0
\end{bmatrix}
\end{equation} 


\begin{equation} \label{eqn:14}
 B=
\begin{bmatrix}
1/L & 0 & 0 & 0 \\
0 & 1/L & 0 & 0 \\
0 & 0 & 1/L & 0 \\
0 & 0 & 0 & 1/L \\
0 & 0 & 0 & 0 \\
\end{bmatrix}
\end{equation} 




\subsection{Wady i zalety}




\section{Field Orient Control}
 \label{chapter:1}
 
 Algorytm wektorowy FOC (ang. Field Orient Control) przedstawiony schematycznie na rysunku \ref{fig:9} jest jedn¹ z powszechnie stosowanych metod sterowania silników trójfazowych. Polega na bezpoœrednim sterowaniu wiruj¹cym polem stojana\cite{Przepiorkowski2010FOC}.  Pozwala uzyskaæ dok³adn¹ i dynamiczn¹ regulacjê prêdkoœci i momentu w szerokim zakresie.
 \\
 
\begin{figure}[H]
\centering
\includegraphics[width=14cm]{diagramFOC.png}   
\caption{Algorytm FOC \cite{Frick2018BLDC}}
\label{fig:9}
\end{figure} 
 
Metoda FOC steruje pr¹dami fazowymi stojana reprezentowanymi w postaci wektora. Czujniki pr¹du dostarczaj¹ informacjê zwrotn¹ o aktualnych pr¹dach fazowych. Za pomoc¹ transformaty Clark’a, wyra¿ona za pomoc¹ wzoru   \ref{eqn:15} i pokazana na rysunku \ref{fig:6},   przekszta³ca siê trójwymiarowy uk³ad wspó³rzêdnych, w którym opisane s¹ pr¹dy fazowe Ia,Ib,Ic na uk³ad ograniczony tylko do dwóch wspó³rzêdnych otrzymuj¹c wiruj¹cy wektor na p³aszczyŸnie. Znaj¹c aktualne po³o¿enie wirnika i korzystaj¹c z transformaty Park’a, wyra¿ona we wzorze \ref{eqn:16} i pokazana na rysunku \ref{fig:7}, uzyskujemy wiruj¹cy uk³ad wspó³rzêdnych . Operacja ta pozwala to na przekszta³cenie wiruj¹cego wektora pr¹du na dwie sk³adowe sta³e Id, Iq. Id jest wielkoœci¹ odpowiadaj¹c¹ strumieniowi magnetycznemu a Iq momentowi obrotowemu silnika. Minimalizuj¹c wartoœæ Id zapewniamy k¹t prosty miêdzy polem magnetycznym stojana i wirnika oraz uzyskujemy najwiêksza sprawnoœæ silnika\cite{Przepiorkowski2010FOC}
\cite{europe1998field}.
\\


\begin{figure}[H]
\centering
\includegraphics[width=7cm]{clark.png}   
\caption{Transformata Clark'a \cite{europe1998field}}
\label{fig:6}
\end{figure} 

\begin{equation} \label{eqn:15}
\left\{ \begin{array}{ll}
I_{\alpha}=I_{A}\\
I_{\beta}=\frac{1}{\sqrt{3}}I_{A}+\frac{2}{\sqrt{3}}I_{B} \\
\end{array} \right. 
\end{equation} 
\\




\begin{figure}[H]
\centering
\includegraphics[width=8cm]{park.png}   
\caption{Transformata Clark'a \cite{europe1998field}}
\label{fig:7}
\end{figure} 

\begin{equation} \label{eqn:16}
\left\{ \begin{array}{ll}
I_{d}=I_{\alpha}cos(\theta)+I_{\beta}sin(\theta)\\
I_{q}=I_{\alpha}sin(\theta)+I_{\beta}cos(\theta)
\end{array} \right. 
\end{equation} 
\\

 
Algorytm FOC pozwala uzyskaæ z trzech przebiegów pr¹dów przemiennych, dwie sk³adowe sta³opr¹dowe. Pozwala to na zastosowanie dwóch regulatorów PID dla sk³adowej Id oraz Iq uzyskuj¹c regulator pr¹du(momentu). Regulacje prêdkoœci obrotowej i po³o¿enia wirnika mo¿na zrealizowaæ przez dodanie kolejnych regulatorów PID do ga³êzi ze sta³¹ Iq. 
 

Zastosowanie odwrotnych transformat pozwala na sprowadzenie sk³adowych sta³ych na trzy przebiegi  sinusoidalne i wprowadzenie tych wartoœci na kolejny blok algorytmu FOC zwany SVPWM (ang. Space Vector Pulse Width Mudulation) opisany w rozdziale \ref{chapter:2}. Blok ten steruje bramkami tranzystorów przetwornika, aby uzyskaæ w uzwojeniach takie przebiegi pr¹dów, które bêd¹ generowa³y odpowiedni¹ amplitudê i prêdkoœæ wirowania pola magnetycznego stojana wzglêdem pola wirnika.Rysunek \ref{fig:8} przedstawia kolejnoœæ dokonywanych transformacji.

 \begin{figure}[H]
\centering
\includegraphics[width=14cm]{transformacje.png}   
\caption{Transformacje w algorytmie FOC \cite{Frick2018BLDC}}
\label{fig:8}
\end{figure}  

\section{SVPWM}
 \label{chapter:2}
 
 Wydajnoœæ pr¹dowa mikrokontrolera jest niewystarczaj¹ca aby zasiliæ silnik, dlatego uzwojenia stojana s¹ bezpoœrednio pod³¹czone do przekszta³tnika energoelektronicznego. Na rysunku \ref{fig:4} przedstawiony jest uproszczony schemat.  Zasilany jest on napiêciem sta³ym. Elementami wykonawczymi s¹ tranzystory mocy. 
 W przekszta³tniku trójfazowym jest grupa trzech zaworów dodatnich i ujemnych. W ka¿dej chwili aktywne s¹ trzy zawory. W ten sposób uzyskujemy osiem mo¿liwych kombinacji za³¹czeñ tranzystorów, które generuj¹ osiem wektorów i dziel¹ przestrzeñ na szeœæ sektorów.Schemat przedstawiony na \\ rysunku \ref{fig:9}

 \begin{figure}[H]
\centering
\includegraphics[width=7cm]{hexagon.png}   
\caption{Wektory w przestrzeni stanu i podzia³ na sektory \cite{Frick2018BLDC}}
\label{fig:9}
\end{figure} 
 
Na przyk³adzie rysunku \ref{fig:10} zosta³ objaœniony sposób generowania dowolnego wektora wed³ug metody SVPWM.  Wektor Vx znajdujê siê w sektorze pierwszym i jest wynikiem dodania do siebie trzech wektorów Va, Vb, Vo, gdzie Vo jest wektorem zerowym.

 \begin{figure}[H]
\centering
\includegraphics[width=7cm]{svpwm.png}   
\caption{Generowanie wektora Vx \cite{mansour2015novel}}
\label{fig:10}
\end{figure} 

Dla sektora pierwszego wektor Va jest zgodny z kierunkiem wektora V1 a wektor Vb z kierunkiem wektora V2. D³ugoœæ obu wektorów jest determinowana przez czas, w którym dana sekwencja zaworów (reprezentowana przez okreœlony wektor V1,…,V6) jest aktywna. Z wyra¿enia X mo¿na wyznaczyæ czasy, które s¹ potrzebne, aby wygenerowaæ dany wektor:

Suma czasów potrzebnych do  wygenerowania wektorów Va, Vb i wektora zerowego jest równa okresowi  modulacji szerokoœci impulsów.




\section{Wnioski}



%% The List of Figures

\addcontentsline{toc}{section}{Wykaz ilustracji}
\listoffigures

\bibliographystyle{plain} %Style of Bibliography: plain / apalike / amsalpha / ...
\bibliography{bibl} %You need a~file 'literature.bib' for this.

\end{document}






